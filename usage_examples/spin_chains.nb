(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     56508,       1244]
NotebookOptionsPosition[     48947,       1093]
NotebookOutlinePosition[     54741,       1213]
CellTagsIndexPosition[     54698,       1210]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spin chains", "Title",
 CellChangeTimes->{{3.960484343557192*^9, 
  3.960484345277008*^9}},ExpressionUUID->"f9a05065-9ce8-4531-bbba-\
c7ac8cbb3df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"Get", "[", "\"\<../QMB.wl\>\"", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.960484690791768*^9, 3.9604846948554487`*^9}, {
  3.960485169512496*^9, 3.960485195771887*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"8a91ecb0-fbc1-4a67-9079-cd1ed265ba7b"],

Cell[CellGroupData[{

Cell["Hamiltonians", "Chapter",
 CellChangeTimes->{{3.960484357698223*^9, 
  3.9604843607884417`*^9}},ExpressionUUID->"1fcd0e7c-049f-4ac7-b223-\
729e282f2429"],

Cell[CellGroupData[{

Cell["IsingHamiltonian", "Section",
 CellChangeTimes->{
  3.9604844035109663`*^9},ExpressionUUID->"be88a67b-0fea-49a6-92a3-\
430501e080b0"],

Cell["\<\
Constructs an sparse array representing the Hamiltonian of the Ising model \
with transverse and longitudinal fields in the computational basis:\
\>", "Text",
 CellChangeTimes->{{3.9604844934451227`*^9, 
  3.960484529187449*^9}},ExpressionUUID->"7f99f445-ddb3-451e-ac22-\
a71ac4dbceec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hx", "=", 
   RowBox[{"hz", "=", 
    RowBox[{"J", "=", "1."}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"chain", " ", "length"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"IsingHamiltonian", "[", 
     RowBox[{"hx", ",", "hz", ",", "J", ",", "L"}], "]"}]}], ",", 
   RowBox[{"MatrixForm", "[", "H", "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.960484413802972*^9, 3.960484462651209*^9}, {
  3.960484535633724*^9, 3.960484536892313*^9}, {3.960484664068647*^9, 
  3.96048467275895*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"412f0ddd-cf33-4024-a7c4-57d5a0ff91c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKn63
VyKgSfCi/RKpb9VJcx/atzQ+v3d46VuS1eMSV3gfqi1cd9SeAQpEtpx8ONnv
8oC5E5f6b9HWgUJCl+wvmG9erqd12L58mvG7B7ue0txeaoUzrc2htfsHKtxw
xftAhQMuc67fvG+9bO9De81DCYLXbr60n6K1uVZ8xnuah9tApc/Blr8Gyp24
xAFvnzNP
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["32", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKn63
VyKgSfCi/RKpb9VJcx/atzQ+v3d46VuS1eMSV3gfqi1cd9SeAQpEtpx8ONnv
8oC5E5f6b9HWgUJCl+wvmG9erqd12L58mvG7B7ue0txeaoUzrc2htfsHKtxw
xftAhQMuc67fvG+9bO9De81DCYLXbr60n6K1uVZ8xnuah9tApc/Blr8Gyp24
xAFvnzNP
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["32", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.5`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {8, 8}, 0., {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {2}, {3}, {5}, {2}, {1}, {
       4}, {6}, {3}, {4}, {1}, {7}, {4}, {3}, {2}, {8}, {5}, {6}, {7}, {1}, {
       6}, {5}, {8}, {2}, {7}, {8}, {5}, {3}, {8}, {7}, {6}, {4}}}, {1., 1., 
      1., 1., 1., 1., 1., 1., 3., 1., 1., 1., -1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., -1., 1., 1., 1., -5., 1., 1., 1.}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "1.`", "1.`", "0.`", "1.`", "0.`", "0.`", "0.`"},
       {"1.`", "1.`", "0.`", "1.`", "0.`", "1.`", "0.`", "0.`"},
       {"1.`", "0.`", "3.`", "1.`", "0.`", "0.`", "1.`", "0.`"},
       {"0.`", "1.`", "1.`", 
        RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "1.`"},
       {"1.`", "0.`", "0.`", "0.`", "1.`", "1.`", "1.`", "0.`"},
       {"0.`", "1.`", "0.`", "0.`", "1.`", "1.`", "0.`", "1.`"},
       {"0.`", "0.`", "1.`", "0.`", "1.`", "0.`", 
        RowBox[{"-", "1.`"}], "1.`"},
       {"0.`", "0.`", "0.`", "1.`", "0.`", "1.`", "1.`", 
        RowBox[{"-", "5.`"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0., {
       1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {2}, {3}, {5}, {2}, {1}, {
         4}, {6}, {3}, {4}, {1}, {7}, {4}, {3}, {2}, {8}, {5}, {6}, {7}, {
         1}, {6}, {5}, {8}, {2}, {7}, {8}, {5}, {3}, {8}, {7}, {6}, {4}}}, {
        1., 1., 1., 1., 1., 1., 1., 1., 3., 1., 1., 1., -1., 1., 1., 1., 1., 
        1., 1., 1., 1., 1., 1., 1., -1., 1., 1., 1., -5., 1., 1., 1.}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9604844823639593`*^9, 3.960484539724742*^9, {3.960484666415573*^9, 
   3.960484673778907*^9}, 3.960484713765725*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"ea40fdb5-82b6-4346-bf3a-ca558f1c932b"]
}, Open  ]],

Cell["\<\
By default, IsingHamiltonian considers open boundary condiitons, but you can \
also specify periodic boundary conditions:\
\>", "Text",
 CellChangeTimes->{{3.960484569105364*^9, 
  3.960484629920556*^9}},ExpressionUUID->"f682469a-cd25-4984-af09-\
7d745a27a79a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hx", "=", 
   RowBox[{"hz", "=", 
    RowBox[{"J", "=", "1."}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"chain", " ", "length"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"IsingHamiltonian", "[", 
     RowBox[{"hx", ",", "hz", ",", "J", ",", "L", ",", 
      RowBox[{"BoundaryConditions", "->", "\"\<Periodic\>\""}]}], "]"}]}], ",", 
   RowBox[{"MatrixForm", "[", "H", "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.960484723742673*^9, 3.960484742063294*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"64403602-824c-4c00-b713-d13ea44646b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKp7S
HWedOfuivU77ItlzHY/tD2keuetX/I5k9bjEFd6HagvXHbVngAKRLScfTva7
PGDuHK72Uiu+qJWuLhw0Xuj56LF9+5w32w0YXtvv+NsZdnrLe5q7Z6D8S2v3
kBqeA5XOcblzsOUvWscXrd0JAIGxG98=
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["32", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKp7S
HWedOfuivU77ItlzHY/tD2keuetX/I5k9bjEFd6HagvXHbVngAKRLScfTva7
PGDuHK72Uiu+qJWuLhw0Xuj56LF9+5w32w0YXtvv+NsZdnrLe5q7Z6D8S2v3
kBqeA5XOcblzsOUvWscXrd0JAIGxG98=
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["32", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.5`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1.`", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {8, 8}, 0., {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {2}, {3}, {5}, {2}, {1}, {
       4}, {6}, {3}, {4}, {1}, {7}, {4}, {3}, {2}, {8}, {5}, {6}, {7}, {1}, {
       6}, {5}, {8}, {2}, {7}, {8}, {5}, {3}, {8}, {7}, {6}, {4}}}, {0., 1., 
      1., 1., 2., 1., 1., 1., 2., 1., 1., 1., 0., 1., 1., 1., 2., 1., 1., 1., 
      0., 1., 1., 1., 0., 1., 1., 1., -6., 1., 1., 1.}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.`", "1.`", "1.`", "0.`", "1.`", "0.`", "0.`", "0.`"},
       {"1.`", "2.`", "0.`", "1.`", "0.`", "1.`", "0.`", "0.`"},
       {"1.`", "0.`", "2.`", "1.`", "0.`", "0.`", "1.`", "0.`"},
       {"0.`", "1.`", "1.`", "0.`", "0.`", "0.`", "0.`", "1.`"},
       {"1.`", "0.`", "0.`", "0.`", "2.`", "1.`", "1.`", "0.`"},
       {"0.`", "1.`", "0.`", "0.`", "1.`", "0.`", "0.`", "1.`"},
       {"0.`", "0.`", "1.`", "0.`", "1.`", "0.`", "0.`", "1.`"},
       {"0.`", "0.`", "0.`", "1.`", "0.`", "1.`", "1.`", 
        RowBox[{"-", "6.`"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0., {
       1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {2}, {3}, {5}, {2}, {1}, {
         4}, {6}, {3}, {4}, {1}, {7}, {4}, {3}, {2}, {8}, {5}, {6}, {7}, {
         1}, {6}, {5}, {8}, {2}, {7}, {8}, {5}, {3}, {8}, {7}, {6}, {4}}}, {
        0., 1., 1., 1., 2., 1., 1., 1., 2., 1., 1., 1., 0., 1., 1., 1., 2., 
        1., 1., 1., 0., 1., 1., 1., 0., 1., 1., 1., -6., 1., 1., 1.}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.960484742366638*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"a7ede2a2-c1b6-48ee-9a0a-94bd339dda49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symmetries", "Subsection",
 CellChangeTimes->{{3.960484794513564*^9, 
  3.96048479614571*^9}},ExpressionUUID->"e9a5426d-0ca7-46d4-9874-\
a399dd197a64"],

Cell[TextData[{
 "Using BlockDiagonalize you may compute the symmetry sectors of \
pseudomomentum ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a641abb5-75e1-4962-b159-155d2cda54a5"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "1", ",", "2"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7be649bf-bc79-4889-b3a7-fe4ebc427b76"],
 " in this example):"
}], "Text",
 CellChangeTimes->{{3.960484799389841*^9, 3.960484862217121*^9}, {
  3.960484895077076*^9, 3.960484896172821*^9}, {3.9604852734958982`*^9, 
  3.960485299102983*^9}},ExpressionUUID->"492e4a86-3bde-4626-95b0-\
ebc48fd2e789"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hx", "=", 
   RowBox[{"hz", "=", 
    RowBox[{"J", "=", "1."}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"chain", " ", "length"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"blockH", "=", 
    RowBox[{"BlockDiagonalize", "[", 
     RowBox[{"IsingHamiltonian", "[", 
      RowBox[{"hx", ",", "hz", ",", "J", ",", "L", ",", 
       RowBox[{"BoundaryConditions", "->", "\"\<Periodic\>\""}]}], "]"}], 
     "]"}]}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"blockH", "[", "\"\<Blocks\>\"", "]"}]}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.96048487866538*^9, 3.960484928617082*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"235ba2bd-9d5f-4e1a-86c1-9195ca4ff490"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["BlockDiagonalMatrix",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPlPjO
Bzz/6j5esJ926ragn/ZD+1nK2vt5yt4OmHtIdn+3gevOLS/sb7gvX1cz7a39
yYjcf/Ff3w+Yv0bDk7ruEff7+YdjyX37zCNntQUvvbD/d+irfHzde3uF96Ha
wnVH7RmgQGTLyYeT/S4PunAj1V8DFZ44451Efw2U+ECFJ6niAAHOL4M=
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPlPjO
Bzz/6j5esJ926ragn/ZD+1nK2vt5yt4OmHtIdn+3gevOLS/sb7gvX1cz7a39
yYjcf/Ff3w+Yv0bDk7ruEff7+YdjyX37zCNntQUvvbD/d+irfHzde3uF96Ha
wnVH7RmgQGTLyYeT/S4PunAj1V8DFZ44451Efw2U+ECFJ6niAAHOL4M=
                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
                 "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    BlockDiagonalMatrix[
     StructuredArray`StructuredData[{8, 
      8}, {{SparseArray[
        Automatic, {4, 4}, 0, {
         1, {{0, 1, 4, 6, 8}, {{2}, {1}, {2}, {3}, {2}, {4}, {3}, {4}}}, {
          1.7320508075688776`, 1.7320508075688776`, 2.0000000000000004`, 
          2.0000000000000004`, 2.0000000000000004`, 1.7320508075688776`, 
          1.7320508075688776`, -6.}}], SparseArray[
        Automatic, {2, 2}, 0, {
         1, {{0, 2, 3}, {{1}, {2}, {1}}}, {
          2., Complex[0.5, 0.8660254037844386], Complex[
           0.49999999999999994`, -0.8660254037844386]}}], SparseArray[
        Automatic, {2, 2}, 0, {
         1, {{0, 2, 3}, {{1}, {2}, {1}}}, {
          2., Complex[0.5, -0.8660254037844386], Complex[
           0.49999999999999994`, 0.8660254037844386]}}]}, {1, 2, 3, 4, 5, 6, 
       7, 8}, {1, 2, 3, 4, 5, 6, 7, 8}}]],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1.7320508075688776`", "0", "0"},
         {"1.7320508075688776`", "2.0000000000000004`", "2.0000000000000004`",
           "0"},
         {"0", "2.0000000000000004`", "0", "1.7320508075688776`"},
         {"0", "0", "1.7320508075688776`", 
          RowBox[{"-", "6.`"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[
       SparseArray[
        Automatic, {4, 4}, 0, {
         1, {{0, 1, 4, 6, 8}, {{2}, {1}, {2}, {3}, {2}, {4}, {3}, {4}}}, {
          1.7320508075688776`, 1.7320508075688776`, 2.0000000000000004`, 
          2.0000000000000004`, 2.0000000000000004`, 1.7320508075688776`, 
          1.7320508075688776`, -6.}}]]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"2.`", 
          RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.8660254037844386`", " ", "\[ImaginaryI]"}]}]},
         {
          RowBox[{"0.49999999999999994`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.8660254037844386`", " ", "\[ImaginaryI]"}]}], "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[
       SparseArray[
        Automatic, {2, 2}, 0, {
         1, {{0, 2, 3}, {{1}, {2}, {1}}}, {
          2., Complex[0.5, 0.8660254037844386], Complex[
           0.49999999999999994`, -0.8660254037844386]}}]]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"2.`", 
          RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.8660254037844386`", " ", "\[ImaginaryI]"}]}]},
         {
          RowBox[{"0.49999999999999994`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.8660254037844386`", " ", "\[ImaginaryI]"}]}], "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[
       SparseArray[
        Automatic, {2, 2}, 0, {
         1, {{0, 2, 3}, {{1}, {2}, {1}}}, {
          2., Complex[0.5, -0.8660254037844386], Complex[
           0.49999999999999994`, 0.8660254037844386]}}]]]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.960484879838378*^9, 3.960484929085243*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"34a142e5-37b1-405e-a779-888442bf5a36"]
}, Open  ]],

Cell["\<\
BlockDiagonalize is an efficient function that works for large chains:\
\>", "Text",
 CellChangeTimes->{{3.960484953755597*^9, 
  3.960484969462942*^9}},ExpressionUUID->"8d1a61b4-18f4-4251-903d-\
1719898c402d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hx", "=", 
   RowBox[{"hz", "=", 
    RowBox[{"J", "=", "1."}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "15"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"chain", " ", "length"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"BlockDiagonalize", "[", 
   RowBox[{"IsingHamiltonian", "[", 
    RowBox[{"hx", ",", "hz", ",", "J", ",", "L", ",", 
     RowBox[{"BoundaryConditions", "->", "\"\<Periodic\>\""}]}], "]"}], "]"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.960484980712726*^9, 3.9604850091889153`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"ebd853c5-a771-46f0-b06f-743476d1e919"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.663296`", ",", 
   TagBox[
    TemplateBox[{
      RowBox[{
        StyleBox[
         TagBox["BlockDiagonalMatrix", "SummaryHead"], 
         "NonInterpretableSummary"], 
        StyleBox["[", "NonInterpretableSummary"], 
        DynamicModuleBox[{
         Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
         TemplateBox[{
           TemplateBox[{
             PaneSelectorBox[{False -> GridBox[{{
                   GraphicsBox[
                    RasterBox[CompressedData["
1:eJzl0FsoQwEcx/GTSblEFM0Qc6+VMmUe3EJeFCWUzQOi0FyLKNeV9qKkmFwi
9iALUaJEkWuSN6lhzs52tvGAKEmRlP/Tz+UJazu1PrXv7+Gcv7i8Pr9SwDCM
x8fPlaHnLu1z2S/+t5++9uQtmFFYQdqtprCxEbMXIPWu5u3M+TwWpH5/z4Rl
bRrA79/Lfu7zU+dTZbsLCjNIO5UyNLg3zgBSn64S3ZRssSD1no55nU1vBh3l
fkkPGveyFAtIO7E6QxZdyIHUcxeHH7UrFpC6slsaJMjmQUe5n2rW+ByzbwJp
Vxqwp23oPgepJzS5ySd0RpC6dGZbpJ6zgn91v43sKeG1C0q7Ou61SKIxg9RD
EoeEGrkJ/Kv3/+9uK5xrj+/jQNrpJIPh1SYOpN54KuNfbm2gs9xvtPXFN0eN
0i45q99vuf4SpF4zsD7eILSB9nI/z+IRRVuPBaRd816jl/hQD1IfHXl/rkB7
+b7f7v7p/NFBqRGknY8qbGzAhQOpdxgjKwvkZ6Cz3O9kurP2eIcHabfcol0q
DrSC1KMqOHZSegU6y/3eABGr9xI=
                    "], {{0, 0}, {10, 10}}, {0, 1}], AspectRatio -> 1, Axes -> 
                    False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                    Thickness[Tiny], 
                    Opacity[0.5]], FrameTicks -> {{None, None}, {None, None}},
                     Axes -> False, AspectRatio -> 1, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}], Frame -> True, FrameTicks -> None, 
                    FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]], ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                   GridBox[{{
                    RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"32768", ",", "32768"}], "}"}], 
                    "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {
                    ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 BaselinePosition -> {1, 1}], True -> GridBox[{{
                   GraphicsBox[
                    RasterBox[CompressedData["
1:eJzl0FsoQwEcx/GTSblEFM0Qc6+VMmUe3EJeFCWUzQOi0FyLKNeV9qKkmFwi
9iALUaJEkWuSN6lhzs52tvGAKEmRlP/Tz+UJazu1PrXv7+Gcv7i8Pr9SwDCM
x8fPlaHnLu1z2S/+t5++9uQtmFFYQdqtprCxEbMXIPWu5u3M+TwWpH5/z4Rl
bRrA79/Lfu7zU+dTZbsLCjNIO5UyNLg3zgBSn64S3ZRssSD1no55nU1vBh3l
fkkPGveyFAtIO7E6QxZdyIHUcxeHH7UrFpC6slsaJMjmQUe5n2rW+ByzbwJp
Vxqwp23oPgepJzS5ySd0RpC6dGZbpJ6zgn91v43sKeG1C0q7Ou61SKIxg9RD
EoeEGrkJ/Kv3/+9uK5xrj+/jQNrpJIPh1SYOpN54KuNfbm2gs9xvtPXFN0eN
0i45q99vuf4SpF4zsD7eILSB9nI/z+IRRVuPBaRd816jl/hQD1IfHXl/rkB7
+b7f7v7p/NFBqRGknY8qbGzAhQOpdxgjKwvkZ6Cz3O9kurP2eIcHabfcol0q
DrSC1KMqOHZSegU6y/3eABGr9xI=
                    "], {{0, 0}, {10, 10}}, {0, 1}], AspectRatio -> 1, Axes -> 
                    False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                    Thickness[Tiny], 
                    Opacity[0.5]], FrameTicks -> {{None, None}, {None, None}},
                     Axes -> False, AspectRatio -> 1, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}], Frame -> True, FrameTicks -> None, 
                    FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]], ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                   GridBox[{{
                    RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"32768", ",", "32768"}], "}"}], 
                    "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {
                    ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                 False, GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 BaselinePosition -> {1, 1}]}, 
              Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
            "SummaryPanel"], 
           ButtonBox[
            DynamicBox[
             ToBoxes[
              If[
               
               Or[$VersionNumber < 11.2, CurrentValue["RunningEvaluator"] =!= 
                "Local"], 
               Style["This object cannot be used as input.", "SummaryEmbed"], 
               
               BoxForm`EmbedSummaryLabel[BlockDiagonalMatrix, 23443600, 
                Dynamic[Typeset`embedState$$], Automatic]], StandardForm]], 
            ButtonFunction :> 
            BoxForm`EmbedSummaryInterpretation[
             "Choose", BlockDiagonalMatrix, 23443600, 
              7498227491146925586262599266325094884661901709857906046688, 
              EvaluationBox[], 
              Dynamic[Typeset`embedState$$], StandardForm, 
              ElisionsDump`embedSummaryBoxes], DefaultBaseStyle -> 
            "SummaryEmbedButton", ImageSize -> Inherited, 
            BaseStyle -> {"DialogStyle"}, Enabled -> Dynamic[
              
              And[$VersionNumber >= 11.2, CurrentValue["RunningEvaluator"] === 
               "Local", Typeset`embedState$$ === "Ready"]], Appearance -> 
            Inherited, Method -> Inherited, Evaluator -> Automatic]}, 
          "SummaryEmbedGrid"], DynamicModuleValues :> {}], 
        StyleBox["]", "NonInterpretableSummary"]}]},
     "CopyTag",
     DisplayFunction->(#& ),
     InterpretationFunction->(
      "BlockDiagonalMatrix[{32768, 32768}, -Structured Data-]"& )],
    False,
    BoxID -> 7498227491146925586262599266325094884661901709857906046688,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "}"}]], "Output",
 CellChangeTimes->{{3.960484996220202*^9, 3.96048501507722*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"e8f1a3f4-ed18-4cd9-92cb-15ccc4514ad5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1435.5, 761.25},
WindowMargins->{{-2.25, Automatic}, {46.5, -22.5}},
InputAliases-><|"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> 
  RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> 
  RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[SelectionPlaceholder]"], 
     "\[Placeholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "pints" -> 
  TemplateBox[{}, "PositiveIntegers"], "npints" -> 
  TemplateBox[{}, "NonPositiveIntegers"], "nnints" -> 
  TemplateBox[{}, "NonNegativeIntegers"], "nints" -> 
  TemplateBox[{}, "NegativeIntegers"], "prats" -> 
  TemplateBox[{}, "PositiveRationals"], "nprats" -> 
  TemplateBox[{}, "NonPositiveRationals"], "nnrats" -> 
  TemplateBox[{}, "NonNegativeRationals"], "nrats" -> 
  TemplateBox[{}, "NegativeRationals"], "preals" -> 
  TemplateBox[{}, "PositiveReals"], "npreals" -> 
  TemplateBox[{}, "NonPositiveReals"], "nnreals" -> 
  TemplateBox[{}, "NonNegativeReals"], "nreals" -> 
  TemplateBox[{}, "NegativeReals"], "dlim" -> RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "tue" -> OverscriptBox["\[UndirectedEdge]", "\[Placeholder]"], "tde" -> 
  OverscriptBox["\[DirectedEdge]", "\[Placeholder]"], "cB" -> 
  TemplateBox[{}, "CombinatorB"], "cC" -> TemplateBox[{}, "CombinatorC"], 
  "cI" -> TemplateBox[{}, "CombinatorI"], "cK" -> 
  TemplateBox[{}, "CombinatorK"], "cS" -> TemplateBox[{}, "CombinatorS"], 
  "cW" -> TemplateBox[{}, "CombinatorW"], "cY" -> 
  TemplateBox[{}, "CombinatorY"], "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "cf" -> 
  SubscriptBox["&", "\[Placeholder]"]|>,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bb471dd4-9013-40c6-94b4-67854ebdbe4e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 154, 3, 72, "Title",ExpressionUUID->"f9a05065-9ce8-4531-bbba-c7ac8cbb3df0"],
Cell[733, 27, 397, 8, 34, "Input",ExpressionUUID->"8a91ecb0-fbc1-4a67-9079-cd1ed265ba7b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1155, 39, 159, 3, 50, "Chapter",ExpressionUUID->"1fcd0e7c-049f-4ac7-b223-729e282f2429"],
Cell[CellGroupData[{
Cell[1339, 46, 139, 3, 49, "Section",ExpressionUUID->"be88a67b-0fea-49a6-92a3-430501e080b0"],
Cell[1481, 51, 296, 6, 25, "Text",ExpressionUUID->"7f99f445-ddb3-451e-ac22-a71ac4dbceec"],
Cell[CellGroupData[{
Cell[1802, 61, 735, 19, 52, "Input",ExpressionUUID->"412f0ddd-cf33-4024-a7c4-57d5a0ff91c8"],
Cell[2540, 82, 12480, 258, 111, "Output",ExpressionUUID->"ea40fdb5-82b6-4346-bf3a-ca558f1c932b"]
}, Open  ]],
Cell[15035, 343, 271, 6, 25, "Text",ExpressionUUID->"f682469a-cd25-4984-af09-7d745a27a79a"],
Cell[CellGroupData[{
Cell[15331, 353, 708, 18, 52, "Input",ExpressionUUID->"64403602-824c-4c00-b713-d13ea44646b4"],
Cell[16042, 373, 12255, 252, 111, "Output",ExpressionUUID->"a7ede2a2-c1b6-48ee-9a0a-94bd339dda49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28334, 630, 157, 3, 39, "Subsection",ExpressionUUID->"e9a5426d-0ca7-46d4-9874-a399dd197a64"],
Cell[28494, 635, 695, 19, 25, "Text",ExpressionUUID->"492e4a86-3bde-4626-95b0-ebc48fd2e789"],
Cell[CellGroupData[{
Cell[29214, 658, 811, 21, 52, "Input",ExpressionUUID->"235ba2bd-9d5f-4e1a-86c1-9195ca4ff490"],
Cell[30028, 681, 10029, 217, 60, "Output",ExpressionUUID->"34a142e5-37b1-405e-a779-888442bf5a36"]
}, Open  ]],
Cell[40072, 901, 220, 5, 25, "Text",ExpressionUUID->"8d1a61b4-18f4-4251-903d-1719898c402d"],
Cell[CellGroupData[{
Cell[40317, 910, 688, 17, 52, "Input",ExpressionUUID->"ebd853c5-a771-46f0-b06f-743476d1e919"],
Cell[41008, 929, 7875, 157, 62, "Output",ExpressionUUID->"e8f1a3f4-ed18-4cd9-92cb-15ccc4514ad5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

